(function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.Tobi=t()})(this,function(){"use strict";const e=function(e){let t={};const n=window;let r=0,o=null,i=null,a=null,l=null,s=null,d={},c=!1,u=!1,p=!1,b=null,f=null,h=null,m=null,g=null,y=!1,v=!1;const A=[],w=[];let _=0;const E={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0};let L={},x=null,C=null;const S=function(e){const t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M14 18l-6-6 6-6"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M10 6l6 6-6 6"/></svg>'],navLabel:["Previous image","Next image"],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6 6l12 12M6 18L18 6"/></svg>',closeLabel:"Close lightbox",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download image",keyboard:!0,zoom:!0,zoomText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M21 16v5h-5"/><path d="M8 21H3v-5"/><path d="M16 3h5v5"/><path d="M3 8V3h5"/></svg>',docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},I={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)(\?.*)?$/i)},init:function(e,n){const o=document.createElement("figure"),i=document.createElement("figcaption"),a=document.createElement("img"),l=e.querySelector("img"),s=document.createElement("div");a.style.opacity="0",l&&(a.alt=l.alt||""),a.setAttribute("src",""),a.setAttribute("data-src",e.href),o.appendChild(a),t.captions&&(i.style.opacity="0","self"===t.captionsSelector&&e.getAttribute(t.captionAttribute)?i.textContent=e.getAttribute(t.captionAttribute):"img"===t.captionsSelector&&l&&l.getAttribute(t.captionAttribute)&&(i.textContent=l.getAttribute(t.captionAttribute)),i.textContent&&(i.id="tobi-figcaption-"+r,o.appendChild(i),a.setAttribute("aria-labelledby",i.id),++r)),n.appendChild(o),s.className="tobi-loader",s.setAttribute("role","progressbar"),s.setAttribute("aria-label",t.loadingIndicatorLabel),n.appendChild(s),n.setAttribute("data-type","image")},onPreload:function(e){I.image.onLoad(e)},onLoad:function(e){const t=e.querySelector("img");if(!t.hasAttribute("data-src"))return;const n=e.querySelector("figcaption"),r=e.querySelector(".tobi-loader");t.onload=function(){e.removeChild(r),t.style.opacity="1",n&&(n.style.opacity="1")},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")},onLeave:function(e){},onCleanup:function(e){}},html:{checkSupport:function(e){return de(e,"html")},init:function(e,t){const n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),r=document.querySelector(n);if(!r)throw new Error("Ups, I can't find the target "+n+".");t.appendChild(r),t.setAttribute("data-type","html")},onPreload:function(e){},onLoad:function(e){const n=e.querySelector("video");n&&(n.hasAttribute("data-time")&&n.readyState>0&&(n.currentTime=n.getAttribute("data-time")),t.autoplayVideo&&n.play())},onLeave:function(e){const t=e.querySelector("video");t&&(t.paused||t.pause(),t.readyState>0&&t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){const t=e.querySelector("video");if(t&&t.readyState>0&&t.readyState<3&&t.duration!==t.currentTime){const n=t.cloneNode(!0);ce(t),t.load(),t.parentNode.removeChild(t),e.appendChild(n)}}},iframe:{checkSupport:function(e){return de(e,"iframe")},init:function(e,t){const n=document.createElement("iframe"),r=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");n.setAttribute("frameborder","0"),n.setAttribute("src",""),n.setAttribute("data-src",r),e.getAttribute("data-width")&&(n.style.maxWidth=e.getAttribute("data-width")+"px"),e.getAttribute("data-height")&&(n.style.maxHeight=e.getAttribute("data-height")+"px"),t.appendChild(n),t.setAttribute("data-type","iframe")},onPreload:function(e){},onLoad:function(e){const t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(e){},onCleanup:function(e){}},youtube:{checkSupport:function(e){return de(e,"youtube")},init:function(e,t){const n=document.createElement("div");t.appendChild(n),w[_]=new window.YT.Player(n,{host:"https://www.youtube-nocookie.com",height:e.getAttribute("data-height")||"360",width:e.getAttribute("data-width")||"640",videoId:e.getAttribute("data-id"),playerVars:{controls:e.getAttribute("data-controls")||1,rel:0,playsinline:1}}),t.setAttribute("data-player",_),t.setAttribute("data-type","youtube"),_++},onPreload:function(e){},onLoad:function(e){t.autoplayVideo&&w[e.getAttribute("data-player")].playVideo()},onLeave:function(e){1===w[e.getAttribute("data-player")].getPlayerState()&&w[e.getAttribute("data-player")].pauseVideo()},onCleanup:function(e){1===w[e.getAttribute("data-player")].getPlayerState()&&w[e.getAttribute("data-player")].pauseVideo()}}};Object.entries||(Object.entries=function(e){const t=Object.keys(e);let n=t.length;const r=new Array(n);for(;n--;)r[n]=[t[n],e[t[n]]];return r});const T=function(e){t=S(e),o||X();const n=document.querySelectorAll(t.selector);if(!n)throw new Error("Ups, I can't find the selector "+t.selector+".");Array.prototype.forEach.call(n,function(e){N(e)})},N=function(e,t){if(null===document.querySelector('[data-type="youtube"]')||v)P(e,t);else{if(null===document.getElementById("iframe_api")){const e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.id="iframe_api",e.src="https://www.youtube.com/iframe_api",t.parentNode.insertBefore(e,t)}-1===A.indexOf(e)&&A.push(e),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(A,function(e){P(e,t)}),v=!0}}},O=function(e){return e.hasAttribute("data-group")?e.getAttribute("data-group"):"default"},k=function(e){return JSON.parse(JSON.stringify(e))},P=function(e,n){if(x=O(e),Object.prototype.hasOwnProperty.call(L,x)||(L[x]=k(E),M()),-1!==L[x].gallery.indexOf(e))throw new Error("Ups, element already added to the lightbox.");if(L[x].gallery.push(e),L[x].elementsLength++,t.zoom&&e.querySelector("img")){const n=document.createElement("div");n.className="tobi-zoom__icon",n.innerHTML=t.zoomText,e.classList.add("tobi-zoom"),e.appendChild(n)}e.addEventListener("click",$),Y(e),he()&&x===C&&(ue(),be()),n&&n.call(this)},q=function(e,n){const r=O(e);if(-1===L[r].gallery.indexOf(e));else{const o=L[r].gallery.indexOf(e),i=L[r].sliderElements[o];if(L[r].elementsLength--,t.zoom&&e.querySelector(".tobi-zoom__icon")){const t=e.querySelector(".tobi-zoom__icon");t.parentNode.classList.remove("tobi-zoom"),t.parentNode.removeChild(t)}e.removeEventListener("click",$),i.parentNode.removeChild(i),he()&&r===C&&(ue(),be()),n&&n.call(this)}},X=function(){o=document.createElement("div"),o.setAttribute("role","dialog"),o.setAttribute("aria-hidden","true"),o.className="tobi",i=document.createElement("button"),i.className="tobi__prev",i.setAttribute("type","button"),i.setAttribute("aria-label",t.navLabel[0]),i.innerHTML=t.navText[0],o.appendChild(i),a=document.createElement("button"),a.className="tobi__next",a.setAttribute("type","button"),a.setAttribute("aria-label",t.navLabel[1]),a.innerHTML=t.navText[1],o.appendChild(a),l=document.createElement("button"),l.className="tobi__close",l.setAttribute("type","button"),l.setAttribute("aria-label",t.closeLabel),l.innerHTML=t.closeText,o.appendChild(l),s=document.createElement("div"),s.className="tobi__counter",o.appendChild(s),n.addEventListener("resize",function(){y||(y=!0,n.requestAnimationFrame(function(){G(),y=!1}))}),document.body.appendChild(o)},M=function(){L[x].slider=document.createElement("div"),L[x].slider.className="tobi__slider",o.appendChild(L[x].slider)},Y=function(e){for(let t in I)if(Object.prototype.hasOwnProperty.call(I,t)&&I[t].checkSupport(e)){const n=document.createElement("div"),r=document.createElement("div");n.className="tobi__slider__slide",n.style.position="absolute",n.style.left=100*L[x].x+"%",r.className="tobi__slider__slide__content",I[t].init(e,r),n.appendChild(r),L[x].slider.appendChild(n),L[x].sliderElements.push(n),++L[x].x;break}},j=function(e,n){if(C=null!==C?C:x,he()||e||(e=0),he()){if(!e)throw new Error("Ups, Tobi is aleady open.");if(e===L[C].currentIndex)throw new Error("Ups, slide "+e+" is already selected.")}if(-1===e||e>=L[C].elementsLength)throw new Error("Ups, I can't find slide "+e+".");t.hideScrollbar&&(document.documentElement.classList.add("tobi-is-open"),document.body.classList.add("tobi-is-open")),ue(),t.close||(l.disabled=!1,l.setAttribute("aria-hidden","true")),b=document.activeElement,L[C].currentIndex=e,F(),le(),U(L[C].currentIndex),o.setAttribute("aria-hidden","false"),be(),D(L[C].currentIndex+1),D(L[C].currentIndex-1),n&&n.call(this)},z=function(e){if(!he())throw new Error("Tobi is already closed.");t.hideScrollbar&&(document.documentElement.classList.remove("tobi-is-open"),document.body.classList.remove("tobi-is-open")),se(),b.focus();const n=L[C].sliderElements[L[C].currentIndex].querySelector(".tobi__slider__slide__content"),r=n.getAttribute("data-type");I[r].onLeave(n),I[r].onCleanup(n),o.setAttribute("aria-hidden","true"),L[C].currentIndex=0,e&&e.call(this)},D=function(e){if(void 0===L[C].sliderElements[e])return;const t=L[C].sliderElements[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");I[n].onPreload(t)},U=function(e){if(void 0===L[C].sliderElements[e])return;const t=L[C].sliderElements[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");I[n].onLoad(t)},V=function(e){L[C].currentIndex>0&&(B(L[C].currentIndex),U(--L[C].currentIndex),be("left"),R(L[C].currentIndex+1),D(L[C].currentIndex-1),e&&e.call(this))},H=function(e){L[C].currentIndex<L[C].elementsLength-1&&(B(L[C].currentIndex),U(++L[C].currentIndex),be("right"),R(L[C].currentIndex-1),D(L[C].currentIndex+1),e&&e.call(this))},B=function(e){if(void 0===L[C].sliderElements[e])return;const t=L[C].sliderElements[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");I[n].onLeave(t)},R=function(e){if(void 0===L[C].sliderElements[e])return;const t=L[C].sliderElements[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");I[n].onCleanup(t)},G=function(){C=null!==C?C:x,m=-L[C].currentIndex*window.innerWidth,L[C].slider.style.transform="translate3d("+m+"px, 0, 0)",g=m},J=function(){s.textContent=L[C].currentIndex+1+"/"+L[C].elementsLength},W=function(e){let n=null;t.nav?(i.disabled=!1,a.disabled=!1,"left"===e?i.focus():a.focus(),1===L[C].elementsLength?(i.disabled=!0,a.disabled=!0,t.close&&l.focus()):(0===L[C].currentIndex&&(i.disabled=!0,a.focus()),L[C].currentIndex===L[C].elementsLength-1&&(a.disabled=!0,i.focus()))):t.close&&l.focus(),n=o.querySelectorAll(".tobi > button:not(:disabled)"),f=n[0],h=1===n.length?n[0]:n[n.length-1]},F=function(){d={startX:0,endX:0,startY:0,endY:0}},K=function(){const e=d.endX-d.startX,n=d.endY-d.startY,r=Math.abs(e),o=Math.abs(n);e>0&&r>t.threshold&&L[C].currentIndex>0?V():e<0&&r>t.threshold&&L[C].currentIndex!==L[C].elementsLength-1?H():n<0&&o>t.threshold&&t.swipeClose?z():G()},$=function(e){e.preventDefault(),C=O(this),j(L[C].gallery.indexOf(this))},Q=function(e){e.target===i?V():e.target===a?H():(e.target===l||"tobi__slider__slide"===e.target.className&&t.docClose)&&z(),e.stopPropagation()},Z=function(e){9===e.keyCode||"Tab"===e.code?e.shiftKey?document.activeElement===f&&(h.focus(),e.preventDefault()):document.activeElement===h&&(f.focus(),e.preventDefault()):27===e.keyCode||"Escape"===e.code?(e.preventDefault(),z()):37===e.keyCode||"ArrowLeft"===e.code?(e.preventDefault(),V()):39!==e.keyCode&&"ArrowRight"!==e.code||(e.preventDefault(),H())},ee=function(e){ge(e.target)||(e.stopPropagation(),p=!0,d.startX=e.touches[0].pageX,d.startY=e.touches[0].pageY,L[C].slider.classList.add("tobi__slider--is-dragging"))},te=function(e){e.stopPropagation(),p&&(e.preventDefault(),d.endX=e.touches[0].pageX,d.endY=e.touches[0].pageY,ae())},ne=function(e){e.stopPropagation(),p=!1,L[C].slider.classList.remove("tobi__slider--is-dragging"),d.endX&&(c=!1,u=!1,K()),F()},re=function(e){ge(e.target)||(e.preventDefault(),e.stopPropagation(),p=!0,d.startX=e.pageX,d.startY=e.pageY,L[C].slider.classList.add("tobi__slider--is-dragging"))},oe=function(e){e.preventDefault(),p&&(d.endX=e.pageX,d.endY=e.pageY,ae())},ie=function(e){e.stopPropagation(),p=!1,L[C].slider.classList.remove("tobi__slider--is-dragging"),d.endX&&(c=!1,u=!1,K()),F()},ae=function(){Math.abs(d.startX-d.endX)>0&&!u&&t.swipeClose?(L[C].slider.style.transform="translate3d("+(g-Math.round(d.startX-d.endX))+"px, 0, 0)",c=!0,u=!1):Math.abs(d.startY-d.endY)>0&&!c&&(L[C].slider.style.transform="translate3d("+g+"px, -"+Math.round(d.startY-d.endY)+"px, 0)",c=!1,u=!0)},le=function(){t.keyboard&&document.addEventListener("keydown",Z),o.addEventListener("click",Q),t.draggable&&(me()&&(o.addEventListener("touchstart",ee),o.addEventListener("touchmove",te),o.addEventListener("touchend",ne)),o.addEventListener("mousedown",re),o.addEventListener("mouseup",ie),o.addEventListener("mousemove",oe))},se=function(){t.keyboard&&document.removeEventListener("keydown",Z),o.removeEventListener("click",Q),t.draggable&&(me()&&(o.removeEventListener("touchstart",ee),o.removeEventListener("touchmove",te),o.removeEventListener("touchend",ne)),o.removeEventListener("mousedown",re),o.removeEventListener("mouseup",ie),o.removeEventListener("mousemove",oe))},de=function(e,t){return e.getAttribute("data-type")===t},ce=function(e){const t=e.querySelectorAll("src");t&&Array.prototype.forEach.call(t,function(e){e.setAttribute("src","")})},ue=function(){t.draggable&&L[C].elementsLength>1&&!L[C].slider.classList.contains("tobi__slider--is-draggable")&&L[C].slider.classList.add("tobi__slider--is-draggable"),!t.nav||1===L[C].elementsLength||"auto"===t.nav&&me()?(i.setAttribute("aria-hidden","true"),a.setAttribute("aria-hidden","true")):(i.setAttribute("aria-hidden","false"),a.setAttribute("aria-hidden","false")),t.counter&&1!==L[C].elementsLength?s.setAttribute("aria-hidden","false"):s.setAttribute("aria-hidden","true")},pe=function(){for(let e in L)Object.prototype.hasOwnProperty.call(L,e)&&(L[e].slider.style.display=C===e?"block":"none")},be=function(e){pe(),G(),J(),W(e)},fe=function(e){he()&&z();const t=Object.entries(L);Array.prototype.forEach.call(t,function(e){const t=e[1].gallery;Array.prototype.forEach.call(t,function(e){q(e)})}),o.parentNode.removeChild(o),L={},x=C=null,r=0,e&&e.call(this)},he=function(){return"false"===o.getAttribute("aria-hidden")},me=function(){return"ontouchstart"in window},ge=function(e){return-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.nodeName)||e===i||e===a||e===l||1===L[C].elementsLength},ye=function(){return L[C].currentIndex},ve=function(){return null!==C?C:x},Ae=function(e){if(he())throw new Error("Ups, I can't do this. Tobi is open.");if(e){if(e&&!Object.prototype.hasOwnProperty.call(L,e))throw new Error("Ups, I don't have a group called \""+e+'".');C=e}};return T(e),{open:j,prev:V,next:H,close:z,add:N,remove:q,destroy:fe,isOpen:he,currentSlide:ye,selectGroup:Ae,currentGroup:ve}};return e});
